---
title: Cloudflare Tunnels
description: Exponer servicios locales de forma segura sin abrir puertos
sidebar:
  order: 10
---

import { Steps, Aside, Badge } from '@astrojs/starlight/components';

# Cloudflare Tunnels

<Badge text="Home Lab" variant="tip" /> <Badge text="Seguridad" variant="note" />

Cloudflare Tunnels permite exponer servicios de tu red local a Internet de forma segura, **sin necesidad de abrir puertos** en tu router.

## ğŸ¤” Â¿Por quÃ© usar Tunnels?

| Sin Tunnels | Con Tunnels |
|:------------|:------------|
| âŒ Requiere abrir puertos | âœ… No requiere puertos abiertos |
| âŒ IP pÃºblica expuesta | âœ… TrÃ¡fico encriptado vÃ­a Cloudflare |
| âŒ ConfiguraciÃ³n de firewall compleja | âœ… ConfiguraciÃ³n simple |
| âŒ Vulnerable a ataques directos | âœ… ProtecciÃ³n DDoS incluida |

## ğŸš€ InstalaciÃ³n

<Steps>

1. **Instala cloudflared** en tu servidor:

   ```bash
   # Debian/Ubuntu
   curl -L --output cloudflared.deb https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb
   sudo dpkg -i cloudflared.deb
   ```

2. **AutentÃ­cate** con tu cuenta de Cloudflare:

   ```bash
   cloudflared tunnel login
   ```

3. **Crea un tÃºnel**:

   ```bash
   cloudflared tunnel create mi-homelab
   ```

4. **Configura el tÃºnel** creando `~/.cloudflared/config.yml`:

   ```yaml
   tunnel: <TUNNEL_ID>
   credentials-file: /home/usuario/.cloudflared/<TUNNEL_ID>.json

   ingress:
     - hostname: docs.herwingx.dev
       service: http://localhost:4321
     - hostname: app.herwingx.dev
       service: http://localhost:3000
     - service: http_status:404
   ```

5. **Configura DNS** en Cloudflare:

   ```bash
   cloudflared tunnel route dns mi-homelab docs.herwingx.dev
   ```

6. **Inicia el tÃºnel** como servicio:

   ```bash
   sudo cloudflared service install
   sudo systemctl start cloudflared
   sudo systemctl enable cloudflared
   ```

</Steps>

## ğŸ” SSH sobre Tunnels

Para CI/CD con GitHub Actions, puedes exponer SSH de forma segura:

```yaml
# En config.yml
ingress:
  - hostname: ssh.herwingx.dev
    service: ssh://localhost:22
```

<Aside type="caution" title="Seguridad">
Siempre configura **Cloudflare Access** para proteger endpoints sensibles como SSH. Usa Service Tokens para autenticaciÃ³n automatizada desde CI/CD.
</Aside>

## ğŸ“‹ Comandos Ãštiles

```bash
# Ver tÃºneles
cloudflared tunnel list

# Ver estado
systemctl status cloudflared

# Ver logs
journalctl -u cloudflared -f

# Ejecutar manualmente (debug)
cloudflared tunnel run mi-homelab
```

## ğŸ”— Referencias

- [DocumentaciÃ³n de Cloudflare Tunnels](https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/)
- [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/policies/access/)
